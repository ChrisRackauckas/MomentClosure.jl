<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · MomentClosure.jl</title><link rel="canonical" href="https://augustinas1.github.io/MomentClosure.jl/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MomentClosure.jl</span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Features"><span>Features</span></a></li><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Illustrative-example"><span>Illustrative example</span></a></li><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="theory/moment_expansion/">Moment Expansion</a></li><li><a class="tocitem" href="theory/moment_closure_approximations/">Moment Closure Approximations</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="tutorials/model_initialisation/">Model initialisation</a></li><li><a class="tocitem" href="tutorials/SSA/">SSA</a></li><li><a class="tocitem" href="tutorials/moment_closure/">Moment Closure</a></li><li><a class="tocitem" href="tutorials/Brusselator/">Brusselator</a></li><li><a class="tocitem" href="tutorials/P53_system/">P53 system</a></li><li><a class="tocitem" href="tutorials/derivative_matching_example/">Derivative Matching</a></li><li><a class="tocitem" href="tutorials/gene_network/">Gene network</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="api/momentclosure_api/">MomentClosure.jl API</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/augustinas1/MomentClosure.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="MomentClosure"><a class="docs-heading-anchor" href="#MomentClosure">MomentClosure</a><a id="MomentClosure-1"></a><a class="docs-heading-anchor-permalink" href="#MomentClosure" title="Permalink"></a></h1><ul><li><a href="api/momentclosure_api/#MomentClosure.cumulants_to_central_moments"><code>MomentClosure.cumulants_to_central_moments</code></a></li><li><a href="#MomentClosure.cumulants_to_central_moments-Tuple{Int64,Int64}"><code>MomentClosure.cumulants_to_central_moments</code></a></li><li><a href="api/momentclosure_api/#MomentClosure.cumulants_to_raw_moments"><code>MomentClosure.cumulants_to_raw_moments</code></a></li><li><a href="#MomentClosure.cumulants_to_raw_moments-Tuple{Int64,Int64}"><code>MomentClosure.cumulants_to_raw_moments</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.cumulants_to_central_moments-Tuple{Int64,Int64}" href="#MomentClosure.cumulants_to_central_moments-Tuple{Int64,Int64}"><code>MomentClosure.cumulants_to_central_moments</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">cumulants_to_central_moments(N::Int, max_order::Int)</code></pre><p>Express all <code>N</code>-variate cumulants <span>$κ$</span> up to order given by <code>max_order</code> in terms of raw moments <span>$M$</span>. Return a Dictionary mapping from vector <span>$\mathbf{i}$</span> (that indicates the cumulant <span>$κ_{\mathbf{i}}$</span>) to the corresponding central moment expressions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/e8a2e683a6aa0c992de488cf0bfa88f0983f2088/src/moment_convert.jl#LL82-L89">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.cumulants_to_raw_moments-Tuple{Int64,Int64}" href="#MomentClosure.cumulants_to_raw_moments-Tuple{Int64,Int64}"><code>MomentClosure.cumulants_to_raw_moments</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">cumulants_to_raw_moments(N::Int, max_order::Int)</code></pre><p>Express all <code>N</code>-variate cumulants <span>$κ$</span> up to order given by <code>max_order</code> in terms of raw moments <span>$μ$</span>. Return a Dictionary mapping from vector <span>$\mathbf{i}$</span> (that indicates the cumulant <span>$κ_{\mathbf{i}}$</span>) to the corresponding raw moment expressions.</p><p><strong>Example</strong></p><pre><code class="language-julia">cumulants_to_raw_moments(2, 2)

Dict{Any,Any} with 5 entries:
  (1, 0) =&gt; μ₁₀(t)
  (2, 0) =&gt; μ₂₀(t) - ((μ₁₀(t))^2)
  (0, 1) =&gt; μ₀₁(t)
  (0, 2) =&gt; μ₀₂(t) - ((μ₀₁(t))^2)
  (1, 1) =&gt; μ₁₁(t) - ((μ₀₁(t))*(μ₁₀(t)))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/e8a2e683a6aa0c992de488cf0bfa88f0983f2088/src/moment_convert.jl#LL1-L21">source</a></section></article><p>MomentClosure.jl is a tool to automatically obtain time-evolution equations of moments up to an arbitrary order for virtually any chemical reaction network implementing a wide array of moment closure approximations commonly used in stochastic biochemical kinetics [1]. MomentClosure is (attempted to be) fairly well-integrated within the broader Julia ecosystem utilising a number of familiar packages:</p><ul><li>MomentClosure can be immediately applied to reaction network models defined using <a href="https://github.com/SciML/Catalyst.jl/issues/22">Catalyst</a>.</li><li>Moment equations are generated as a <a href="https://github.com/SciML/ModelingToolkit.jl">ModelingToolkit</a> <a href="https://mtk.sciml.ai/stable/systems/ODESystem/"><code>ODESystem</code></a> (with some extra help from <a href="https://github.com/JuliaSymbolics/SymbolicUtils.jl">SymbolicUtils</a>).</li><li>The resulting <code>ODESystem</code> can be solved using any <a href="https://github.com/SciML/DifferentialEquations.jl/">DifferentialEquations</a> ODE solvers, enabling further study of the system using <a href="https://diffeq.sciml.ai/stable/analysis/parameter_estimation/">parameter estimation</a>, <a href="https://diffeq.sciml.ai/stable/analysis/sensitivity/">sensitivity analysis</a> and <a href="https://diffeq.sciml.ai/stable/analysis/bifurcation/">bifurcation analysis</a> tools (have no example/test for these yet!).</li></ul><h2 id="Features"><a class="docs-heading-anchor" href="#Features">Features</a><a id="Features-1"></a><a class="docs-heading-anchor-permalink" href="#Features" title="Permalink"></a></h2><ul><li>Chemical reaction networks containing any number of molecular species and reactions with any type of <em>smooth</em> propensity functions are supported.</li><li>Models can be defined using <a href="https://github.com/SciML/Catalyst.jl/issues/22">Catalyst</a> as <a href="https://catalyst.sciml.ai/dev/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ModelingToolkit.ReactionSystem</code></a>. Alternatively, built-in functionality (heavily based on Catalyst) can be used for model initialisation.</li><li>Added (experimental and limited) support for reaction networks involving reaction products that are geometrically distributed random variables. An example of such network is an autoregulatory gene network with bursty protein production where the burst size follows a geometric distribution. To our knowledge, such models cannot be defined using Catalyst and hence modelled using the broader <a href="https://github.com/SciML/">SciML framework</a>. For this reason, we also include an implementation of the Gillespie&#39;s Stochastic Simulation Algorithm [2] generally applicable to such reaction networks (yet to be added).</li><li>Equations describing the time evolution of means and central moments of the number of molecules of each species in the system can be generated up to arbitrary order [3, 4]. Note that non-polynomial propensity functions are Taylor expanded to a specified order. Raw moment equations can also be generated for mass-action systems (where all propensity functions are polynomials).</li><li>Currently implemented moment closure approximations include:<ul><li>zero (central-moment neglect) closure [3, 5]</li><li>normal closure [5]</li><li>poisson closure [5]</li><li>log-normal closure [6]</li><li>gamma closure [6]</li><li>derivative matching [7]</li><li>conditional gaussian closure [8]</li><li>conditional derivative matching [8]</li></ul></li><li>Moment equations are constructed as a <a href="https://mtk.sciml.ai/stable/systems/ODESystem/"><code>ModelingToolkit.ODESystem</code></a> that can be solved using any <a href="https://github.com/SciML/DifferentialEquations.jl/">DifferentialEquations</a> ODE solver. Moreover, <a href="https://diffeq.sciml.ai/stable/analysis/parameter_estimation/">parameter estimation</a>, <a href="https://diffeq.sciml.ai/stable/analysis/sensitivity/">sensitivity analysis</a> and <a href="https://diffeq.sciml.ai/stable/analysis/bifurcation/">bifurcation analysis</a> tools can be applied to further study the resulting system of equations.</li><li><a href="https://github.com/korsbo/Latexify.jl">Latexify</a> can be used to generate LaTeX expressions of the corresponding moment equations.</li></ul><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>MomentClosure can be installed through the Julia package manager:</p><pre><code class="language-julia">]add https://github.com/augustinas1/MomentClosure.jl
using MomentClosure</code></pre><p>Note the use of full link to github repo as the package is currently unregistered.</p><h2 id="Illustrative-example"><a class="docs-heading-anchor" href="#Illustrative-example">Illustrative example</a><a id="Illustrative-example-1"></a><a class="docs-heading-anchor-permalink" href="#Illustrative-example" title="Permalink"></a></h2><p>To be added</p><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><p>[1]: D. Schnoerr, G. Sanguinetti, and R. Grima, &quot;Approximation and inference methods for stochastic biochemical kinetics - a tutorial review&quot;, Journal of Physics A: Mathematical and Theoretical 50, 093001 (2017). https://doi.org/10.1088/1751-8121/aa54d9</p><p>[2]: D. T. Gillespie, &quot;A general method for numerically simulating the stochastic time evolution of coupled chemical reactions&quot;, Journal of Computational Physics 22, 403-434 (1976). https://doi.org/10.1016/0021-9991(76)90041-3</p><p>[3]: A. Ale, P. Kirk, and M. P. H. Stumpf, &quot;A general moment expansion method for stochastic kinetic models&quot;, The Journal of Chemical Physics 138, 174101 (2013). https://doi.org/10.1063/1.4802475</p><p>[4]: C. H. Lee, &quot;A Moment Closure Method for Stochastic Chemical Reaction Networks with General Kinetics&quot;, MATCH Communications in Mathematical and in Computer Chemistry 70, 785-800 (2013). https://match.pmf.kg.ac.rs/electronic<em>versions/Match70/n3/match70n3</em>785-800.pdf</p><p>[5]: D. Schnoerr, G. Sanguinetti, and R. Grima, &quot;Comparison of different moment-closure approximations for stochastic chemical kinetics&quot;, The Journal of Chemical Physics 143, 185101 (2015). https://doi.org/10.1063/1.4934990</p><p>[6]: E. Lakatos, A. Ale, P. D. W. Kirk, and M. P. H. Stumpf, &quot;Multivariate moment closure techniques for stochastic kinetic models&quot;, The Journal of Chemical Physics 143, 094107 (2015). https://doi.org/10.1063/1.4929837</p><p>[7]: A. Singh and J. P. Hespanha, &quot;Lognormal Moment Closures for Biochemical Reactions&quot;, in Proceedings of the 45th IEEE Conference on Decision and Control, ISSN: 0191-2216 (Dec. 2006), pp. 2063-2068. https://doi.org/10.1109/CDC.2006.376994</p><p>[8]: M. Soltani, C. A. Vargas-Garcia, and A. Singh, &quot;Conditional Moment Closure Schemes for Studying Stochastic Dynamics of Genetic Circuits&quot;, IEEE Transactions on Biomedical Circuits and Systems 9, 518-526 (2015). https://doi.org/10.1109/TBCAS.2015.2453158</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="theory/moment_expansion/">Moment Expansion »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 25 February 2021 22:49">Thursday 25 February 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

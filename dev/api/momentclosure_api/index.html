<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MomentClosure.jl API · MomentClosure.jl</title><link rel="canonical" href="https://augustinas1.github.io/MomentClosure.jl/api/momentclosure_api/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MomentClosure.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../../theory/moment_expansion/">Moment Expansion</a></li><li><a class="tocitem" href="../../theory/moment_closure_approximations/">Moment Closure Approximations</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/using_momentclosure/">Using MomentClosure</a></li><li><a class="tocitem" href="../../tutorials/P53_system_example/">P53 system</a></li><li><a class="tocitem" href="../../tutorials/derivative_matching_example/">Derivative Matching</a></li><li><a class="tocitem" href="../../tutorials/gene_network_example/">Gene network</a></li></ul></li><li><span class="tocitem">API</span><ul><li class="is-active"><a class="tocitem" href>MomentClosure.jl API</a><ul class="internal"><li><a class="tocitem" href="#Model-definition"><span>Model definition</span></a></li><li><a class="tocitem" href="#Basic-model-properties"><span>Basic model properties</span></a></li><li><a class="tocitem" href="#Moment-Equations"><span>Moment Equations</span></a></li><li><a class="tocitem" href="#Moment-Closure"><span>Moment Closure</span></a></li><li><a class="tocitem" href="#visualisation_api"><span>Displaying Equations and Closures</span></a></li><li><a class="tocitem" href="#Stochastic-Simulation-Utilities"><span>Stochastic Simulation Utilities</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>MomentClosure.jl API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>MomentClosure.jl API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/augustinas1/MomentClosure.jl/blob/master/docs/src/api/momentclosure_api.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="api"><a class="docs-heading-anchor" href="#api">MomentClosure.jl API</a><a id="api-1"></a><a class="docs-heading-anchor-permalink" href="#api" title="Permalink"></a></h1><h2 id="Model-definition"><a class="docs-heading-anchor" href="#Model-definition">Model definition</a><a id="Model-definition-1"></a><a class="docs-heading-anchor-permalink" href="#Model-definition" title="Permalink"></a></h2><p>MomentClosure is fully compatible with reaction network models defined using <a href="https://github.com/SciML/Catalyst.jl">Catalyst</a> and stored as a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ModelingToolkit.ReactionSystem</code></a>. Nevertheless, we have implemented a <em>limited</em> extension of <code>ModelingToolkit.ReactionSystem</code>, called <code>ReactionSystemMod</code>, that allows us to consider systems containing reactions whose products can be independent geometrically distributed random variables. For example, such reactions can be encountered in certain models of <a href="../../tutorials/gene_network_example/#gene_network_example">autoregulatory gene networks</a>. Moreover, <code>ReactionSystemMod</code> provides an alternative to Catalyst as the model is now constructed directly in terms of user-defined reaction propensity functions and the stoichiometric matrix, with system parameters and species defined using ModelingToolkit <a href="https://mtk.sciml.ai/stable/basics/ContextualVariables/#Parameters-1"><code>@parameters</code></a> and Symbolics <a href="https://symbolics.juliasymbolics.org/stable/manual/variables/#Symbolics.@variables"><code>@variables</code></a> respectively. However, we stress that defining models using Catalyst is preferred whenever possible due to its much richer integration within the broader <a href="https://github.com/SciML/">SciML</a> ecosystem.</p><article class="docstring"><header><a class="docstring-binding" id="ModelingToolkit.@parameters" href="#ModelingToolkit.@parameters"><code>ModelingToolkit.@parameters</code></a> — <span class="docstring-category">Macro</span></header><section><div><p>Define one or more known variables.</p></div></section></article><article class="docstring"><header><a class="docstring-binding" id="Symbolics.@variables" href="#Symbolics.@variables"><code>Symbolics.@variables</code></a> — <span class="docstring-category">Macro</span></header><section><div><p>Define one or more unknown variables.</p><pre><code class="language-julia">@parameters t α σ(..) β[1:2]
@variables w(..) x(t) y z(t, α, x)

expr = β₁* x + y^α + σ(3) * (z - t) - β₂ * w(t - 1)</code></pre><p><code>(..)</code> signifies that the value should be left uncalled.</p><p>Sometimes it is convenient to define arrays of variables to model things like <code>x₁,…,x₃</code>. The <code>@variables</code> macro supports this with the following syntax:</p><pre><code class="language-julia">@variables x[1:3];
x

3-element Vector{Num}:
 x₁
 x₂
 x₃

# support for arbitrary ranges and tensors
@variables y[2:3,1:5:6];
y

2×2 Matrix{Num}:
 y₂ˏ₁  y₂ˏ₆
 y₃ˏ₁  y₃ˏ₆

# also works for dependent variables
@variables t z[1:3](t);
z

3-element Array{Num,1}:
 z₁(t)
 z₂(t)
 z₃(t)</code></pre></div></section></article><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.ReactionSystemMod" href="#MomentClosure.ReactionSystemMod"><code>MomentClosure.ReactionSystemMod</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct ReactionSystemMod</code></pre><p>A system of chemical reactions. The structure is heavily based on <code>ModelingToolkit.ReactionSystem</code> and the relevant fields are left identical for the sake of familiar users.</p><p><strong>Fields</strong></p><ul><li><p><code>iv</code></p><p>Independent variable (usually time)</p></li><li><p><code>states</code></p><p>Dependent (state) variables representing amount of each species.</p></li><li><p><code>ps</code></p><p>Parameter variables.</p></li><li><p><code>a</code></p><p>Propensity functions of all reactions</p></li><li><p><code>S</code></p><p>Stoichiometric matrix</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia">@parameters t, c₁, c₂, c₃, c₄, Ω
@variables X(t), Y(t)

# stoichiometric matrix
S_mat = [ 1 -1  1 -1;
         -1  1  0  0]

# propensity functions
a = [c₁*X*Y*(X-1)/Ω^2, c₂*X, c₃*Ω, c₄*X]

rn = ReactionSystemMod(t, [X, Y], [c₁, c₂, c₃, c₄, Ω], a, S_mat)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL6">source</a></section></article><h2 id="Basic-model-properties"><a class="docs-heading-anchor" href="#Basic-model-properties">Basic model properties</a><a id="Basic-model-properties-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-model-properties" title="Permalink"></a></h2><p>To keep the API consistent with Catalyst, we provide a number of identical <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#Basic-properties">basic functions</a> allowing easy access to network properties:</p><article class="docstring"><header><a class="docstring-binding" id="Catalyst.species" href="#Catalyst.species"><code>Catalyst.species</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">species(rn::ReactionSystemMod)</code></pre><p>Given a <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>, return a vector of species variables expressed as <a href="https://mtk.sciml.ai/stable/IR/#Types-1"><code>Term{Real}</code></a>. Extension of Catalyst&#39;s <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#Catalyst.species"><code>species</code></a> used with a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL66-L72">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Catalyst.speciesmap" href="#Catalyst.speciesmap"><code>Catalyst.speciesmap</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">speciesmap(rn::ReactionSystemMod)</code></pre><p>Given a <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>, return a Dictionary mapping from species to species indices. Extension of Catalyst&#39;s <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#Catalyst.speciesmap"><code>speciesmap</code></a> used with a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL88-L94">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Catalyst.params" href="#Catalyst.params"><code>Catalyst.params</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">params(rn::ReactionSystemMod)</code></pre><p>Given a <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>, return a vector of parameter variables expressed as <code>Sym{ModelingToolkit.Parameter{Real}</code>. Extension of  Catalyst&#39;s <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#Catalyst.params"><code>params</code></a> used with a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL77-L83">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Catalyst.paramsmap" href="#Catalyst.paramsmap"><code>Catalyst.paramsmap</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">paramsmap(rn::ReactionSystemMod)</code></pre><p>Given a <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>, return a Dictionary mapping from parameters to parameter indices.  Extension of Catalyst&#39;s <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#Catalyst.paramsmap"><code>paramsmap</code></a> used with a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL99-L105">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Catalyst.numspecies" href="#Catalyst.numspecies"><code>Catalyst.numspecies</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">numspecies(rn::ReactionSystemMod)</code></pre><p>Return the number of species within the given <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>. Extension of Catalyst&#39;s <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#Catalyst.numspecies"><code>numspecies</code></a> used with a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL110-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Catalyst.numparams" href="#Catalyst.numparams"><code>Catalyst.numparams</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">numparams(rn::ReactionSystemMod)</code></pre><p>Return the number of parameters within the given <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>. Extension of Catalyst&#39;s <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#Catalyst.numparams"><code>numparams</code></a> used with a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL130-L135">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Catalyst.numreactions" href="#Catalyst.numreactions"><code>Catalyst.numreactions</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">numreactions(rn::ReactionSystemMod)</code></pre><p>Return the number of reactions within the given <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>. Extension of Catalyst&#39;s <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#Catalyst.numreactions"><code>numreactions</code></a> used with a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL120-L125">source</a></section></article><p>Moreover, we include two slight extensions of the Catalyst API:</p><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.get_S_mat" href="#MomentClosure.get_S_mat"><code>MomentClosure.get_S_mat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">get_S_mat(rn::Union{ReactionSystem, ReactionSystemMod})</code></pre><p>Return the (net) stoichiometric matrix of the given <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a> or <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL140-L145">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.propensities" href="#MomentClosure.propensities"><code>MomentClosure.propensities</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">propensities(rn::Union{ReactionSystem, ReactionSystemMod}; combinatoric_ratelaw=true)</code></pre><p>Return a vector of propensity functions of all reactions in the given <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a> or <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>.</p><p>Notes:</p><ul><li><code>combinatoric_ratelaw=true</code> uses binomials in calculating the propensity functions of a <code>ReactionSystem</code>, see the notes for <a href="https://mtk.sciml.ai/stable/systems/ReactionSystem/#ModelingToolkit.jumpratelaw"><code>ModelingToolkit.jumpratelaw</code></a>. <em>Note</em> that this field is irrelevant using <code>ReactionSystemMod</code> as then the propensities are defined directly by the user.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/reaction_systems.jl#LL154-L166">source</a></section></article><h2 id="Moment-Equations"><a class="docs-heading-anchor" href="#Moment-Equations">Moment Equations</a><a id="Moment-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Moment-Equations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.generate_raw_moment_eqs" href="#MomentClosure.generate_raw_moment_eqs"><code>MomentClosure.generate_raw_moment_eqs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">generate_raw_moment_eqs(rn::Union{ReactionSystem, ReactionSystemMod}, m_order::Int; combinatoric_ratelaw = true)</code></pre><p>Given a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a> or <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>, return the <a href="#MomentClosure.RawMomentEquations"><code>RawMomentEquations</code></a> of the system generated up to <code>m_order</code>.</p><p>Notes:</p><ul><li>The expansion order <span>$q$</span>, denoted by <code>q_order</code> throughout the docs, is automatically determined from the given polynomial form of the propensity functions, see the <a href="../../tutorials/using_momentclosure/#main_tutorial">tutorial</a> and the <a href="../../theory/moment_expansion/#raw_moment_eqs">theory section</a> for more details on how <code>q_order</code> is obtained.</li><li><code>combinatoric_ratelaw=true</code> uses binomials in calculating the propensity functions of a <code>ReactionSystem</code>, see the notes for <a href="https://mtk.sciml.ai/stable/systems/ReactionSystem/#ModelingToolkit.jumpratelaw"><code>ModelingToolkit.jumpratelaw</code></a>. <em>Note</em> that this field is irrelevant using <code>ReactionSystemMod</code> as then the propensities are defined directly by the user.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/raw_moment_equations.jl#LL1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.RawMomentEquations" href="#MomentClosure.RawMomentEquations"><code>MomentClosure.RawMomentEquations</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct RawMomentEquations &lt;: MomentClosure.MomentEquations</code></pre><p>Raw moment equations generated for the given system plus a number of helper parameters (important for internal functionality).</p><p><strong>Fields</strong></p><ul><li><p><code>odes</code></p><p><a href="https://mtk.sciml.ai/stable/systems/ODESystem/"><code>ModelingToolkit.ODESystem</code></a> consisting of the time-evolution equations of raw moments.</p></li><li><p><code>μ</code></p><p>Symbolic variables defining the raw moments.</p></li><li><p><code>N</code></p><p>Number of species within the system.</p></li><li><p><code>m_order</code></p><p>Order of moment equations.</p></li><li><p><code>q_order</code></p><p>Expansion order.</p></li><li><p><code>iter_all</code></p><p>Vector of all index combinations (Tuples) up to <code>q_order</code>.</p></li><li><p><code>iter_m</code></p><p>Vector of all index combinations (Tuples) up to <code>m_order</code>.</p></li><li><p><code>iter_q</code></p><p>Vector of all index combinations (Tuples) of order greater than <code>m_order</code> up to <code>q_order</code>.</p></li><li><p><code>iter_1</code></p><p>Vector of index combinations (Tuples)of order 1.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/moment_equations.jl#LL3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.generate_central_moment_eqs" href="#MomentClosure.generate_central_moment_eqs"><code>MomentClosure.generate_central_moment_eqs</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">generate_central_moment_eqs(rn::Union{ReactionSystem, ReactionSystemMod}, m_order::Int, q_order=nothing; combinatoric_ratelaw = true)</code></pre><p>Given a <a href="https://catalyst.sciml.ai/stable/api/catalyst_api/#ModelingToolkit.ReactionSystem"><code>ReactionSystem</code></a> or <a href="#MomentClosure.ReactionSystemMod"><code>ReactionSystemMod</code></a>, return the <a href="#MomentClosure.CentralMomentEquations"><code>CentralMomentEquations</code></a> of the system generated up to <code>m_order</code>.</p><p>Notes:</p><ul><li>if <code>q_order</code> is not specified by the user, it is assumed that the reaction network contains <em>only</em> polynomial propensity functions and hence <code>q_order</code> is determined automatically as in <a href="#MomentClosure.generate_raw_moment_eqs"><code>generate_raw_moment_eqs</code></a>. However, <code>q_order</code> must be specified if non-polynomial propensities are included. Note that the expansion order <span>$q$</span> denotes the highest order of central moments which will be included in the ODEs <a href="../../theory/moment_expansion/#central_moment_eqs">(due to the Taylor expansion of propensity functions)</a>.</li><li><code>combinatoric_ratelaw=true</code> uses binomials in calculating the propensity functions of a <code>ReactionSystem</code>, see the notes for <a href="https://mtk.sciml.ai/stable/systems/ReactionSystem/#ModelingToolkit.jumpratelaw"><code>ModelingToolkit.jumpratelaw</code></a>. <em>Note</em> that this field is irrelevant using <code>ReactionSystemMod</code> as then the propensities are defined directly by the user.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/central_moment_equations.jl#LL18-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.CentralMomentEquations" href="#MomentClosure.CentralMomentEquations"><code>MomentClosure.CentralMomentEquations</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct CentralMomentEquations &lt;: MomentClosure.MomentEquations</code></pre><p>Central moment equations generated for the given system plus a number of helper parameters (important for internal functionality).</p><p><strong>Fields</strong></p><ul><li><p><code>odes</code></p><p><a href="https://mtk.sciml.ai/stable/systems/ODESystem/"><code>ModelingToolkit.ODESystem</code></a> consisting of the time-evolution equations of central moments.</p></li><li><p><code>μ</code></p><p>Symbolic variables defining the means.</p></li><li><p><code>M</code></p><p>Symbolic variables defining the central moments.</p></li><li><p><code>N</code></p><p>Number of species within the system.</p></li><li><p><code>m_order</code></p><p>Order of moment equations.</p></li><li><p><code>q_order</code></p><p>Expansion order.</p></li><li><p><code>iter_all</code></p><p>Vector of all index combinations up to <code>q_order</code>.</p></li><li><p><code>iter_m</code></p><p>Vector of all index combinations up to <code>m_order</code>.</p></li><li><p><code>iter_q</code></p><p>Vector of all index combinations of order greater than <code>m_order</code> up to <code>q_order</code>.</p></li><li><p><code>iter_1</code></p><p>Vector of index combinations of order 1.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/moment_equations.jl#LL35">source</a></section></article><h2 id="Moment-Closure"><a class="docs-heading-anchor" href="#Moment-Closure">Moment Closure</a><a id="Moment-Closure-1"></a><a class="docs-heading-anchor-permalink" href="#Moment-Closure" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.moment_closure" href="#MomentClosure.moment_closure"><code>MomentClosure.moment_closure</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">moment_closure(sys::MomentEquations, closure::String, binary_vars::Vector=[]; clean=true)</code></pre><p>Given <code>MomentEquations</code>, apply the specified moment closure approximation and return the <a href="#MomentClosure.ClosedMomentEquations"><code>ClosedMomentEquations</code></a>.</p><p>The supported <code>closure</code> options are:</p><ul><li><a href="../../theory/moment_closure_approximations/#zero_closure"><code>&quot;zero&quot;</code></a></li><li><a href="../../theory/moment_closure_approximations/#normal_closure"><code>&quot;normal&quot;</code></a></li><li><a href="../../theory/moment_closure_approximations/#log-normal_closure"><code>&quot;log-normal&quot;</code></a></li><li><a href="../../theory/moment_closure_approximations/#poisson_closure"><code>&quot;poisson&quot;</code></a></li><li><a href="../../theory/moment_closure_approximations/#gamma_closure"><code>&quot;gamma&quot;</code></a></li><li><a href="../../theory/moment_closure_approximations/#derivative_matching"><code>&quot;derivative matching&quot;</code></a></li><li><a href="../../theory/moment_closure_approximations/#conditional_gaussian_closure"><code>&quot;conditional gaussian&quot;</code></a></li><li><a href="../../theory/moment_closure_approximations/#conditional_derivative_matching"><code>&quot;conditional derivative matching&quot;</code></a></li></ul><p><strong>Notes</strong></p><ul><li><code>binary_vars</code> is required in case of conditional closures. It must be specified by denoting in an array the indices of all species whose molecule number is a Bernoulli (binary) variable.</li><li><code>clean</code> argument is only relevant for gamma closure. Namely, <code>clean=true</code> implies that the closure functions and the resulting closed moment equations will be heavily simplified in order to preserve numerical stability. However, this can extremely computationally expensive due to complicated functional form of the higher order moments under gamma closure. Setting <code>clean=false</code> is generally much faster as the symbolic expressions are not simplified internally, but it can lead to severe numerical instabilities.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/closure_methods/closure.jl#LL20-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="MomentClosure.ClosedMomentEquations" href="#MomentClosure.ClosedMomentEquations"><code>MomentClosure.ClosedMomentEquations</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">struct ClosedMomentEquations &lt;: MomentClosure.MomentEquations</code></pre><p>Closed moment equations and the corresponding closure functions.</p><p><strong>Fields</strong></p><ul><li><p><code>odes</code></p><p><a href="https://mtk.sciml.ai/stable/systems/ODESystem/"><code>ModelingToolkit.ODESystem</code></a> consisting of the time-evolution equations of <em>closed</em> moments.</p></li><li><p><code>closure</code></p><p>Dictionary of moment closure functions for each higher order moment.</p></li><li><p><code>open_eqs</code></p><p>Original raw or central moment equations (before closure was applied).</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/augustinas1/MomentClosure.jl/blob/9f20edd2b165adb24a7baa798e48d38cb280f384/src/moment_equations.jl#LL69">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>deterministic_IC</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="visualisation_api"><a class="docs-heading-anchor" href="#visualisation_api">Displaying Equations and Closures</a><a id="visualisation_api-1"></a><a class="docs-heading-anchor-permalink" href="#visualisation_api" title="Permalink"></a></h2><p>The generated moment equations can be converted into LaTeX expressions using <a href="https://github.com/korsbo/Latexify.jl">Latexify</a> as:</p><pre><code class="language-julia">using Latexify
latexify(moment_eqs)</code></pre><p>Note that the <a href="https://mtk.sciml.ai/stable/systems/ODESystem/"><code>ModelingToolkit.ODESystem</code></a> (saved as <code>moment_eqs.odes</code>) can also be passed to <code>latexify</code> function directly.</p><p>Given <a href="#MomentClosure.ClosedMomentEquations"><code>ClosedMomentEquations</code></a>, the closure functions can be visualised in the same way by adding <code>:closure</code> argument:</p><pre><code class="language-julia">latexify(moment_eqs, :closure)</code></pre><h2 id="Stochastic-Simulation-Utilities"><a class="docs-heading-anchor" href="#Stochastic-Simulation-Utilities">Stochastic Simulation Utilities</a><a id="Stochastic-Simulation-Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Stochastic-Simulation-Utilities" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>sample_raw_moments</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>sample_central_moments</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>sample_cumulants</code>. Check Documenter&#39;s build log for details.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../tutorials/gene_network_example/">« Gene network</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Thursday 11 March 2021 16:13">Thursday 11 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
